# Basic Usage

## Creating a Dojo application

The first step for building a Dojo application is to install the CLI

> Command line

```bash
npm install -g @dojo/cli @dojo/cli-create-app
```

This command installs the Dojo command-line tool (`@dojo/cli`) and the Dojo CLI module to create an application (`@dojo/cli-create-app`). There are a number of CLI modules that add commands and functionality to the dojo command-line.

Now create an application using the dojo command.

> Command line

```bash
dojo create app --name my-first-app
```

This command will generate a basic project structure in the `my-first-app` directory. This project will include a `package.json` file, an example Dojo application, and all of the project dependencies will be pre-installed. It will include two additional Dojo CLI modules. [@dojo/cli-build-app](https://github.com/dojo/cli-build-app) and [@dojo/cli-test-intern](https://github.com/dojo/cli-test-intern).

## Building

There are several types of build targets or `mode`s that Dojo's CLI tool supports. All of these modes can be seen in the various `package.json` scripts generated by `dojo create app`.

Run the following to create an optimized build ready for production.

> Command line

```bash
npm run build
```

This build will use the `dist` mode to create an application bundle and output the results in the `output/dist` directory.

## Serving and Watching

A web server can be started with the `--serve` flag while running in `dev` or `dist` modes. By default the application is served on port 9999. This can be cahnged with the `--port` flag. Dojo's build tool can also watch the application for changes and automatically rebuild with the `--watch` flag.

The generated `package.json` includes the `dev` script which uses these flags to serve a built version of the application and automatically rebuild it when files change on disk.

> Command line

```bash
npm run dev
```

The application will also have source maps available. This allows the debugger to map the built JavaScript code back to the original TypeScript code that lives in the `src/` directory.

For more information on how to configure the build options see the [@dojo/cli-build-app](https://github.com/dojo/cli-build-app/blob/master/README.md#configuration) README.

## Testing

Dojo uses [Intern](https://theintern.io/) for running unit and functional tests. Intern supports two types of testing approaches unit and functional. Unit tests may be run in node using [jsdom](https://github.com/jsdom/jsdom) and using [Selenium](https://www.seleniumhq.org/). Functional tests are run using Selenium in the browser and test the overall functionality of the software as a user would interact with it.

A new Dojo application will have example unit and function tests under the `tests` directory. Scripts for running tests are available in the `package.json` file.

The fastest way to run tests is by running them in node using [@dojo/cli-test-intern](https://github.com/dojo/cli-test-intern)'s JIT builder.

> Command line

```bash
npm test
```

This command uses [ts-node](https://www.npmjs.com/package/ts-node) to automatically build and execute unit tests located in `tests/unit` and build code from `src` on demand.

> Command line

```bash
npm run test:unit
```

This command will build the Dojo application and tests into `dojo\test\unit` and use Intern to run tests locally using node and Chrome.

> Command line

```bash
npm run test:functional
```

This command will build the Dojo application and functional tests into `dojo\test\functional` and use Intern to execute tests in Chrome using Selenium.

Intern comes with support for running tests remotely on [BrowserStack](https://www.browserstack.com), [SauceLabs](https://saucelabs.com/), and [TestingBot](https://testingbot.com/). You may use one of these services by signing up for an account and providing your credentials to cli-test-intern. By default, all of the testing services will run tests against IE11, Firefox, and Chrome.

More detailed information is available in the [@dojo/cli-test-intern](https://github.com/dojo/cli-test-intern) repository and from [Intern](https://theintern.io/).

## Browser Support

Dojo is an evergreen framework. By default the build will support the last two versions of the latest browsers when it was released. Any polyfills needed by Dojo to normalize functionality across browsers is conditionally provided by the `@dojo/framework/shim`. To support IE11 run the build with the `--legacy` flag.

# Dojo Configuration

Additional configuration options can be added in `.dojorc`. The options generally expand on the settings available through the command line and allow for more advanced features such as internationalization, code splitting, PWA manifests, and eliding code.

`.dojorc` contains a JSON object with configuration information for any of the commands that are run via the dojo command line tool. Each command is allocated a section within the configuration object where its settings can be stored.

```json
{
	"build-app": {
		"pwa": {
			"manifest": {
				"name": "My Application",
				"description": "My amazing application"
			}
		}
	},
	"test-intern": {},
	"create-widget": {
		"tests": "tests/unit"
	}
}
```

In this example we have a section for each of the three CLI command modules: [@dojo/cli-build-app](https://github.com/dojo/cli-build-app/), [@dojo/cli-test-intern](https://github.com/dojo/cli-test-intern), and [@dojo/cli-create-widget](https://github.com/dojo/cli-create-widget). Configuration is _always_ hierarchical and in the order of command => feature => configuration.
